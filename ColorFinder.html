<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ColorFinder - 颜色代码查询工具</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 统一的 Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        neutral: '#f1f5f9',
                        dark: '#1e293b'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .glass {
                background: rgba(255, 255, 255, 0.25);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }
            .glass-dark {
                background: rgba(30, 41, 59, 0.75);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.08);
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
        }
    </style>
    <style>
        html, body {
            height: 100%;
        }
        body {
            background-image: url("file:///C:/Users/angeh/.cursor/projects/c-Users-angeh-Desktop-vibe-TRAE/assets/c__Users_angeh_Desktop_vibe_TRAE____16.jpg") !important;
            background-size: cover !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            background-attachment: fixed !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-neutral to-gray-200 min-h-screen font-sans text-dark">
    <div class="container mx-auto px-4 py-8 max-w-5xl">
        <!-- 头部 -->
        <header class="text-center mb-8 animate-fade-in">
            <h1 class="text-4xl md:text-5xl font-bold text-primary mb-2 text-shadow" style="color: rgb(247, 15, 131);">ColorFinder</h1>
            <p class="text-lg text-secondary">快速查询并预览颜色代码对应的实际颜色</p>
        </header>

        <!-- 主内容区 -->
        <main class="space-y-8">
            <!-- 颜色输入区域 -->
            <section class="bg-white rounded-xl shadow-lg p-6 animate-slide-up">
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="flex-grow">
                        <label for="color-input" class="block text-sm font-medium text-secondary mb-1">输入颜色代码 (HEX, RGB, HSL)</label>
                        <div class="relative">
                            <input type="text" id="color-input" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-primary transition-all-300 text-lg font-mono" placeholder="#ff0000 或 rgb(255,0,0) 或 hsl(0,100%,50%)" autocomplete="off">
                            <button id="random-color" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary hover:text-primary transition-all-300">
                                <i class="fa fa-random text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button id="copy-btn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 transition-all-300 flex items-center gap-2">
                            <i class="fa fa-copy"></i>
                            <span>复制</span>
                        </button>
                        <button id="save-btn" class="px-4 py-2 bg-secondary text-white rounded-lg hover:bg-slate-600 transition-all-300 flex items-center gap-2">
                            <i class="fa fa-bookmark-o"></i>
                            <span>收藏</span>
                        </button>
                    </div>
                </div>
                
                <!-- 格式切换标签 -->
                <div class="flex gap-2 mt-4">
                    <button class="format-tab px-3 py-1 rounded-md bg-primary text-white" data-format="hex">HEX</button>
                    <button class="format-tab px-3 py-1 rounded-md bg-gray-200 text-secondary hover:bg-gray-300" data-format="rgb">RGB</button>
                    <button class="format-tab px-3 py-1 rounded-md bg-gray-200 text-secondary hover:bg-gray-300" data-format="hsl">HSL</button>
                </div>
            </section>

            <!-- 颜色预览区域 -->
            <section class="animate-slide-up" style="animation-delay: 0.1s;">
                <div id="color-preview" class="w-full h-64 md:h-80 rounded-xl shadow-lg transition-all duration-500 ease-in-out flex items-center justify-center" style="background-color: #ff0000;">
                    <div id="preview-text" class="text-white text-2xl font-bold text-shadow px-6 py-3 glass-dark rounded-lg">
                        #FF0000
                    </div>
                </div>
            </section>

            <!-- 颜色信息区域 -->
            <section class="grid grid-cols-1 md:grid-cols-2 gap-6 animate-slide-up" style="animation-delay: 0.2s;">
                <!-- 颜色详情 -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i class="fa fa-info-circle text-primary"></i>
                        颜色详情
                    </h2>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-secondary">HEX:</span>
                            <span id="hex-value" class="font-mono font-medium">#FF0000</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-secondary">RGB:</span>
                            <span id="rgb-value" class="font-mono font-medium">rgb(255, 0, 0)</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-secondary">HSL:</span>
                            <span id="hsl-value" class="font-mono font-medium">hsl(0, 100%, 50%)</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-secondary">颜色名称:</span>
                            <span id="color-name" class="font-medium">红色</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-secondary">亮度:</span>
                            <span id="luminance-value" class="font-medium">高</span>
                        </div>
                    </div>
                </div>

                <!-- 颜色搭配 -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i class="fa fa-paint-brush text-primary"></i>
                        颜色搭配
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-sm font-medium text-secondary mb-2">互补色</h3>
                            <div id="complementary-color" class="h-16 rounded-lg shadow transition-all duration-500" style="background-color: #00ffff;"></div>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-secondary mb-2">三元配色</h3>
                            <div class="flex gap-2">
                                <div id="triadic-1" class="flex-1 h-12 rounded-lg shadow transition-all duration-500" style="background-color: #ff00ff;"></div>
                                <div id="triadic-2" class="flex-1 h-12 rounded-lg shadow transition-all duration-500" style="background-color: #00ffff;"></div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-secondary mb-2">类似色</h3>
                            <div class="flex gap-2">
                                <div id="analogous-1" class="flex-1 h-12 rounded-lg shadow transition-all duration-500" style="background-color: #ff0080;"></div>
                                <div id="analogous-2" class="flex-1 h-12 rounded-lg shadow transition-all duration-500" style="background-color: #ff8000;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 历史记录和收藏 -->
            <section class="animate-slide-up" style="animation-delay: 0.3s;">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold flex items-center gap-2">
                            <i class="fa fa-history text-primary"></i>
                            历史记录
                        </h2>
                        <button id="clear-history" class="text-sm text-secondary hover:text-red-500 transition-all-300 flex items-center gap-1">
                            <i class="fa fa-trash-o"></i>
                            <span>清空</span>
                        </button>
                    </div>
                    <div id="history-container" class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3">
                        <!-- 历史记录将在这里动态生成 -->
                    </div>
                </div>
            </section>
        </main>

        <!-- 底部 -->
        <footer class="mt-12 text-center text-secondary text-sm">
            <p>© 2025 ColorFinder - 颜色代码查询工具</p>
        </footer>
    </div>

    <!-- 通知提示 -->
    <div id="notification" class="fixed bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center gap-2">
        <i id="notification-icon" class="fa fa-check-circle text-green-500"></i>
        <span id="notification-text">操作成功</span>
    </div>

    <script>
        // 颜色名称映射表
        const colorNames = {
            '#ff0000': '红色', '#00ff00': '绿色', '#0000ff': '蓝色',
            '#ffff00': '黄色', '#ff00ff': '洋红', '#00ffff': '青色',
            '#ffffff': '白色', '#000000': '黑色', '#808080': '灰色',
            '#ffa500': '橙色', '#800080': '紫色', '#a52a2a': '棕色',
            '#ffc0cb': '粉色', '#008000': '深绿色', '#000080': '深蓝色',
            '#800000': '深红色', '#808000': '橄榄色', '#008080': '蓝绿色'
        };

        // DOM 元素
        const colorInput = document.getElementById('color-input');
        const colorPreview = document.getElementById('color-preview');
        const previewText = document.getElementById('preview-text');
        const hexValue = document.getElementById('hex-value');
        const rgbValue = document.getElementById('rgb-value');
        const hslValue = document.getElementById('hsl-value');
        const colorName = document.getElementById('color-name');
        const luminanceValue = document.getElementById('luminance-value');
        const copyBtn = document.getElementById('copy-btn');
        const saveBtn = document.getElementById('save-btn');
        const randomColorBtn = document.getElementById('random-color');
        const clearHistoryBtn = document.getElementById('clear-history');
        const historyContainer = document.getElementById('history-container');
        const notification = document.getElementById('notification');
        const notificationIcon = document.getElementById('notification-icon');
        const notificationText = document.getElementById('notification-text');
        const formatTabs = document.querySelectorAll('.format-tab');

        // 当前颜色状态
        let currentColor = {
            hex: '#ff0000',
            rgb: { r: 255, g: 0, b: 0 },
            hsl: { h: 0, s: 100, l: 50 }
        };

        // 历史记录和收藏
        let history = JSON.parse(localStorage.getItem('colorHistory')) || [];
        let favorites = JSON.parse(localStorage.getItem('colorFavorites')) || [];

        // 初始化页面
        function init() {
            updateColorPreview(currentColor.hex);
            updateColorInfo();
            renderHistory();
            setupEventListeners();
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 颜色输入事件
            colorInput.addEventListener('input', debounce(handleColorInput, 300));
            
            // 复制按钮
            copyBtn.addEventListener('click', () => copyToClipboard(currentColor.hex));
            
            // 收藏按钮
            saveBtn.addEventListener('click', toggleFavorite);
            
            // 随机颜色按钮
            randomColorBtn.addEventListener('click', generateRandomColor);
            
            // 清空历史记录
            clearHistoryBtn.addEventListener('click', clearHistory);
            
            // 格式切换标签
            formatTabs.forEach(tab => {
                tab.addEventListener('click', () => switchFormat(tab.dataset.format));
            });
            
            // 键盘快捷键
            document.addEventListener('keydown', handleKeyboardShortcuts);
        }

        // 处理颜色输入
        function handleColorInput() {
            const input = colorInput.value.trim();
            
            if (!input) return;
            
            // 尝试解析不同格式的颜色输入
            let color = null;
            
            // 尝试解析 HEX
            if (input.match(/^#?[0-9A-F]{6}$/i)) {
                color = parseHexColor(input);
            }
            // 尝试解析 RGB
            else if (input.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i)) {
                color = parseRgbColor(input);
            }
            // 尝试解析 HSL
            else if (input.match(/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/i)) {
                color = parseHslColor(input);
            }
            
            if (color) {
                currentColor = color;
                updateColorPreview(color.hex);
                updateColorInfo();
                addToHistory(color.hex);
            }
        }

        // 解析 HEX 颜色
        function parseHexColor(hex) {
            // 确保 hex 以 # 开头
            if (!hex.startsWith('#')) {
                hex = '#' + hex;
            }
            
            // 解析 RGB 值
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            
            // 转换为 HSL
            const hsl = rgbToHsl(r, g, b);
            
            return {
                hex: hex.toUpperCase(),
                rgb: { r, g, b },
                hsl
            };
        }

        // 解析 RGB 颜色
        function parseRgbColor(rgbString) {
            const match = rgbString.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i);
            
            if (!match) return null;
            
            const r = parseInt(match[1]);
            const g = parseInt(match[2]);
            const b = parseInt(match[3]);
            
            // 验证 RGB 值范围
            if (r < 0 || r > 255 || g < 0 || g > 255 || b < 0 || b > 255) {
                return null;
            }
            
            // 转换为 HEX
            const hex = rgbToHex(r, g, b);
            
            // 转换为 HSL
            const hsl = rgbToHsl(r, g, b);
            
            return {
                hex,
                rgb: { r, g, b },
                hsl
            };
        }

        // 解析 HSL 颜色
        function parseHslColor(hslString) {
            const match = hslString.match(/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/i);
            
            if (!match) return null;
            
            let h = parseInt(match[1]);
            let s = parseInt(match[2]);
            let l = parseInt(match[3]);
            
            // 验证 HSL 值范围
            h = ((h % 360) + 360) % 360; // 确保 h 在 0-359 范围内
            s = Math.max(0, Math.min(100, s)); // 确保 s 在 0-100 范围内
            l = Math.max(0, Math.min(100, l)); // 确保 l 在 0-100 范围内
            
            // 转换为 RGB
            const rgb = hslToRgb(h, s, l);
            
            // 转换为 HEX
            const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
            
            return {
                hex,
                rgb,
                hsl: { h, s, l }
            };
        }

        // RGB 转 HEX
        function rgbToHex(r, g, b) {
            return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
        }

        // RGB 转 HSL
        function rgbToHsl(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0; // 灰色
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                
                h /= 6;
            }
            
            return {
                h: Math.round(h * 360),
                s: Math.round(s * 100),
                l: Math.round(l * 100)
            };
        }

        // HSL 转 RGB
        function hslToRgb(h, s, l) {
            h /= 360;
            s /= 100;
            l /= 100;
            
            let r, g, b;
            
            if (s === 0) {
                r = g = b = l; // 灰色
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        // 更新颜色预览
        function updateColorPreview(hexColor) {
            colorPreview.style.backgroundColor = hexColor;
            
            // 根据颜色亮度调整预览文本颜色
            const { r, g, b } = currentColor.rgb;
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            
            if (brightness > 128) {
                previewText.className = 'text-dark text-2xl font-bold px-6 py-3 glass rounded-lg';
            } else {
                previewText.className = 'text-white text-2xl font-bold text-shadow px-6 py-3 glass-dark rounded-lg';
            }
            
            previewText.textContent = hexColor;
        }

        // 更新颜色信息
        function updateColorInfo() {
            hexValue.textContent = currentColor.hex;
            rgbValue.textContent = `rgb(${currentColor.rgb.r}, ${currentColor.rgb.g}, ${currentColor.rgb.b})`;
            hslValue.textContent = `hsl(${currentColor.hsl.h}, ${currentColor.hsl.s}%, ${currentColor.hsl.l}%)`;
            
            // 更新颜色名称
            const closestColorName = getClosestColorName(currentColor.hex);
            colorName.textContent = closestColorName;
            
            // 更新亮度信息
            const luminance = getLuminance(currentColor.rgb.r, currentColor.rgb.g, currentColor.rgb.b);
            luminanceValue.textContent = getLuminanceCategory(luminance);
            
            // 更新颜色搭配
            updateColorSchemes();
        }

        // 获取最接近的颜色名称
        function getClosestColorName(hex) {
            // 检查是否有精确匹配
            if (colorNames[hex]) {
                return colorNames[hex];
            }
            
            // 如果没有精确匹配，返回通用描述
            const { h, s, l } = currentColor.hsl;
            
            if (l < 10) return '几乎黑色';
            if (l > 90) return '几乎白色';
            if (s < 10) return '灰色';
            
            // 根据色相返回大致颜色
            if (h >= 345 || h < 15) return '红色系';
            if (h >= 15 && h < 45) return '橙色系';
            if (h >= 45 && h < 75) return '黄色系';
            if (h >= 75 && h < 105) return '黄绿色系';
            if (h >= 105 && h < 135) return '绿色系';
            if (h >= 135 && h < 165) return '青绿色系';
            if (h >= 165 && h < 195) return '青色系';
            if (h >= 195 && h < 225) return '蓝绿色系';
            if (h >= 225 && h < 255) return '蓝色系';
            if (h >= 255 && h < 285) return '蓝紫色系';
            if (h >= 285 && h < 315) return '紫色系';
            if (h >= 315 && h < 345) return '紫红色系';
            
            return '自定义颜色';
        }

        // 获取颜色亮度
        function getLuminance(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;
            
            // 应用伽马校正
            r = r <= 0.03928 ? r / 12.92 : Math.pow((r + 0.055) / 1.055, 2.4);
            g = g <= 0.03928 ? g / 12.92 : Math.pow((g + 0.055) / 1.055, 2.4);
            b = b <= 0.03928 ? b / 12.92 : Math.pow((b + 0.055) / 1.055, 2.4);
            
            // 计算相对亮度
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        }

        // 获取亮度分类
        function getLuminanceCategory(luminance) {
            if (luminance < 0.1) return '非常低';
            if (luminance < 0.25) return '低';
            if (luminance < 0.5) return '中低';
            if (luminance < 0.75) return '中高';
            if (luminance < 0.9) return '高';
            return '非常高';
        }

        // 更新颜色搭配
        function updateColorSchemes() {
            const { h, s, l } = currentColor.hsl;
            
            // 互补色
            const complementaryHue = (h + 180) % 360;
            const complementaryColor = hslToRgb(complementaryHue, s, l);
            const complementaryHex = rgbToHex(complementaryColor.r, complementaryColor.g, complementaryColor.b);
            document.getElementById('complementary-color').style.backgroundColor = complementaryHex;
            
            // 三元配色
            const triadicHue1 = (h + 120) % 360;
            const triadicHue2 = (h + 240) % 360;
            const triadicColor1 = hslToRgb(triadicHue1, s, l);
            const triadicColor2 = hslToRgb(triadicHue2, s, l);
            const triadicHex1 = rgbToHex(triadicColor1.r, triadicColor1.g, triadicColor1.b);
            const triadicHex2 = rgbToHex(triadicColor2.r, triadicColor2.g, triadicColor2.b);
            document.getElementById('triadic-1').style.backgroundColor = triadicHex1;
            document.getElementById('triadic-2').style.backgroundColor = triadicHex2;
            
            // 类似色
            const analogousHue1 = (h + 30) % 360;
            const analogousHue2 = (h - 30 + 360) % 360;
            const analogousColor1 = hslToRgb(analogousHue1, s, l);
            const analogousColor2 = hslToRgb(analogousHue2, s, l);
            const analogousHex1 = rgbToHex(analogousColor1.r, analogousColor1.g, analogousColor1.b);
            const analogousHex2 = rgbToHex(analogousColor2.r, analogousColor2.g, analogousColor2.b);
            document.getElementById('analogous-1').style.backgroundColor = analogousHex1;
            document.getElementById('analogous-2').style.backgroundColor = analogousHex2;
        }

        // 添加到历史记录
        function addToHistory(hexColor) {
            // 从历史记录中移除相同的颜色（如果存在）
            history = history.filter(color => color !== hexColor);
            
            // 添加到历史记录开头
            history.unshift(hexColor);
            
            // 限制历史记录数量
            if (history.length > 20) {
                history = history.slice(0, 20);
            }
            
            // 保存到本地存储
            localStorage.setItem('colorHistory', JSON.stringify(history));
            
            // 更新历史记录显示
            renderHistory();
        }

        // 渲染历史记录
        function renderHistory() {
            historyContainer.innerHTML = '';
            
            if (history.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'col-span-full text-center py-4 text-secondary';
                emptyState.textContent = '暂无历史记录';
                historyContainer.appendChild(emptyState);
                return;
            }
            
            history.forEach(color => {
                const colorItem = document.createElement('div');
                colorItem.className = 'h-12 rounded-lg shadow cursor-pointer transition-transform hover:scale-105';
                colorItem.style.backgroundColor = color;
                colorItem.title = color;
                
                // 检查是否为收藏色
                const isFavorite = favorites.includes(color);
                if (isFavorite) {
                    const favoriteIcon = document.createElement('div');
                    favoriteIcon.className = 'w-full h-full flex items-center justify-center text-white text-shadow';
                    favoriteIcon.innerHTML = '<i class="fa fa-star"></i>';
                    colorItem.appendChild(favoriteIcon);
                }
                
                // 点击历史记录项
                colorItem.addEventListener('click', () => {
                    const colorData = parseHexColor(color);
                    currentColor = colorData;
                    colorInput.value = color;
                    updateColorPreview(color);
                    updateColorInfo();
                });
                
                historyContainer.appendChild(colorItem);
            });
        }

        // 切换收藏状态
        function toggleFavorite() {
            const hexColor = currentColor.hex;
            const index = favorites.indexOf(hexColor);
            
            if (index === -1) {
                // 添加到收藏
                favorites.push(hexColor);
                showNotification('颜色已添加到收藏', 'success');
                saveBtn.innerHTML = '<i class="fa fa-bookmark"></i><span>已收藏</span>';
            } else {
                // 从收藏中移除
                favorites.splice(index, 1);
                showNotification('颜色已从收藏中移除', 'info');
                saveBtn.innerHTML = '<i class="fa fa-bookmark-o"></i><span>收藏</span>';
            }
            
            // 保存到本地存储
            localStorage.setItem('colorFavorites', JSON.stringify(favorites));
            
            // 更新历史记录显示
            renderHistory();
        }

        // 清空历史记录
        function clearHistory() {
            if (history.length === 0) return;
            
            if (confirm('确定要清空所有历史记录吗？')) {
                history = [];
                localStorage.removeItem('colorHistory');
                renderHistory();
                showNotification('历史记录已清空', 'info');
            }
        }

        // 生成随机颜色
        function generateRandomColor() {
            const r = Math.floor(Math.random() * 256);
            const g = Math.floor(Math.random() * 256);
            const b = Math.floor(Math.random() * 256);
            
            const hexColor = rgbToHex(r, g, b);
            const colorData = parseHexColor(hexColor);
            
            currentColor = colorData;
            colorInput.value = hexColor;
            updateColorPreview(hexColor);
            updateColorInfo();
            addToHistory(hexColor);
            
            showNotification('已生成随机颜色', 'success');
        }

        // 切换颜色格式
        function switchFormat(format) {
            // 更新标签样式
            formatTabs.forEach(tab => {
                if (tab.dataset.format === format) {
                    tab.className = 'format-tab px-3 py-1 rounded-md bg-primary text-white';
                } else {
                    tab.className = 'format-tab px-3 py-1 rounded-md bg-gray-200 text-secondary hover:bg-gray-300';
                }
            });
            
            // 更新输入框内容
            switch (format) {
                case 'hex':
                    colorInput.value = currentColor.hex;
                    break;
                case 'rgb':
                    colorInput.value = `rgb(${currentColor.rgb.r}, ${currentColor.rgb.g}, ${currentColor.rgb.b})`;
                    break;
                case 'hsl':
                    colorInput.value = `hsl(${currentColor.hsl.h}, ${currentColor.hsl.s}%, ${currentColor.hsl.l}%)`;
                    break;
            }
        }

        // 复制到剪贴板
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('颜色代码已复制到剪贴板', 'success');
            }).catch(err => {
                console.error('复制失败:', err);
                showNotification('复制失败，请手动复制', 'error');
            });
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            notificationText.textContent = message;
            
            // 设置图标和颜色
            switch (type) {
                case 'success':
                    notification.className = 'fixed bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg bg-green-50 text-green-800 transform translate-y-0 opacity-100 transition-all duration-300 flex items-center gap-2';
                    notificationIcon.className = 'fa fa-check-circle text-green-500';
                    break;
                case 'error':
                    notification.className = 'fixed bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg bg-red-50 text-red-800 transform translate-y-0 opacity-100 transition-all duration-300 flex items-center gap-2';
                    notificationIcon.className = 'fa fa-exclamation-circle text-red-500';
                    break;
                case 'info':
                default:
                    notification.className = 'fixed bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg bg-blue-50 text-blue-800 transform translate-y-0 opacity-100 transition-all duration-300 flex items-center gap-2';
                    notificationIcon.className = 'fa fa-info-circle text-blue-500';
                    break;
            }
            
            // 3秒后隐藏通知
            setTimeout(() => {
                notification.className = 'fixed bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center gap-2';
            }, 3000);
        }

        // 处理键盘快捷键
        function handleKeyboardShortcuts(e) {
            // Ctrl/Cmd + C: 复制当前颜色
            if ((e.ctrlKey || e.metaKey) && e.key === 'c' && document.activeElement !== colorInput) {
                e.preventDefault();
                copyToClipboard(currentColor.hex);
            }
            
            // Ctrl/Cmd + S: 切换收藏
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                toggleFavorite();
            }
            
            // Ctrl/Cmd + R: 生成随机颜色
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                generateRandomColor();
            }
            
            // 空格键: 生成随机颜色
            if (e.code === 'Space' && document.activeElement !== colorInput) {
                e.preventDefault();
                generateRandomColor();
            }
        }

        // 防抖函数
        function debounce(func, wait) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    func.apply(context, args);
                }, wait);
            };
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', init);
    </script>

</body></html>